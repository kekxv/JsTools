<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- add the shim first -->
    <script src="../Javascript/shim.min.js"></script>
    <!-- after the shim is referenced, add the library -->
    <script src="../Javascript/xlsx.full.min.js"></script>
    <!--<script src="../Javascript/xlsx.core.min.js"></script>-->
</head>
<body>

</body>

<script>
    div = document.createElement("div");
    div.innerText = "1231231";
    var jsono = [{ //测试数据
        "id": 1,//A
        "B": "数据11",//B
        "C": "数据12",//C
        "D": "数据13",//D
        "E": "数据14",//E
    }, {
        "id": 2,
        "合并的列头1": "数据21",
        "合并的列头2": "数据22",
        "合并的列头3": {
            v: '采购单',
            t: 's',
            s: {
                font: {
                    sz: 18,                //18号字体
                    bold: true             //加粗
                },
                alignment: {
                    horizontal: 'center'   //水平居中对其
                }
            }
        },
        "合并的列头4": "数据24",
    }];//....
    const wopts = {bookType: 'xlsx', bookSST: true, type: 'binary'};//这里的数据是用来定义导出的格式类型
    function downloadExl(data, type) {
        var wb = {SheetNames: ['Sheet1'], Sheets: {}, Props: {}};
        //wb.Sheets['Sheet1'] = XLSX.utils.json_to_sheet(data);//通过json_to_sheet转成单页(Sheet)数据
        data = XLSX.utils.json_to_sheet(data);
        data["B1"] = {t: "s", v: "asdad"};
        data["!merges"] = [{//合并第一行数据[B1,C1,D1,E1]
            s: {//s为开始
                c: 1,//开始列
                r: 0//开始取值范围
            },
            e: {//e结束
                c: 4,//结束列
                r: 0//结束范围
            }
        }];
        wb.Sheets['Sheet1'] = data;
        XLSX.write(wb, wopts);
        console.log(wb);
        XLSX.writeFile(wb, "wopts.xlsx");

    }

    downloadExl(jsono)
</script>
</html>